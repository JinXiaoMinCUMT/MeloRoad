webpackJsonp([2],{Jzdj:function(e,t){},"PN+p":function(e,t){},Stxe:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"Home",props:{placeholder:{type:String,default:"搜索歌曲、歌手"}},data:function(){return{query:""}},methods:{setQuery:function(e){this.query=e}},created:function(){var e,t,s,a=this;this.$watch("query",(e=function(e){a.$emit("query",e)},t=200,s=void 0,function(){for(var a=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];s&&clearTimeout(s),s=setTimeout(function(){e.apply(a,r)},t)}))}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-box"},[s("i",{staticClass:"iconfont icon-search"}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"box",attrs:{placeholder:e.placeholder},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}})])},staticRenderFns:[]};var r=s("vSla")(a,n,!1,function(e){s("jJ4c")},"data-v-68b06a98",null).exports,i=s("cQcd"),o=s("T452"),c=s("aozt"),u=s.n(c);function l(e,t,s,a){var n=Object.assign({},o.c,{w:e,p:t,perpage:a,n:a,catZhida:s?1:0,zhidaqu:1,t:0,flag:1,ie:"utf-8",sem:1,aggr:0,remoteplace:"txt.mqq.all",uin:0,needNewCode:1,platform:"h5",_:1534346388904,format:"json"});return u.a.get("/api/search",{params:n}).then(function(e){return Promise.resolve(e.data)})}var h=s("G3uJ"),d=s("qwAB"),f=s("R8C3"),g=s("HVJf"),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},v={name:"MusicSearchSuggest",props:{query:{type:String,default:""},showSinger:{type:Boolean,default:!0}},components:{Scroll:d.a},data:function(){return{page:1,result:[],pullup:!0,hasMore:!0}},methods:p({selectItem:function(e){if("singer"===e.type){var t=new f.a({id:e.singermid,name:e.singername});this.$router.push({path:"/music-search/"+t.id}),this.setSinger(t)}},searchMore:function(){var e=this;if(!this.hasMore)return"";this.page++,l(this.query,this.page,this.showSinger,20).then(function(t){t.code===o.a&&(console.log(t.data),e.result=e.result.concat(e._genResult(t.data)),console.log(e.result),e._checkMore(t.data))})},_checkMore:function(e){var t=e.song;!t.list.length||t.curnum+20*t.curpage>t.totalnum?this.hasMore=!1:this.hasMore=!0},_search:function(){var e=this;this.hasMore=!0,l(this.query,this.page,this.showSinger,20).then(function(t){t.code===o.a&&(console.log(t.data),e.result=e._genResult(t.data),console.log(e.result),e._checkMore(t.data))})},_genResult:function(e){var t=[];return e.zhida&&e.zhida.singername&&t.push(p({},e.zhida,{type:"singer"})),e.song&&(t=t.concat(this._normalizeSongs(e.song.list))),t},_normalizeSongs:function(e){var t=[];return e.forEach(function(e){e.songid&&e.albummid&&t.push(Object(h.a)(e))}),t},getDisplayName:function(e){return"singer"===e.type?e.singername:e.name+" - "+e.singer}},Object(g.d)({setSinger:"SET_SINGER"})),watch:{query:function(){this._search()}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("scroll",{staticClass:"music-search-suggest",attrs:{data:e.result,pullup:e.pullup},on:{scrollToEnd:e.searchMore}},[s("ul",{staticClass:"suggest-list"},e._l(e.result,function(t,a){return s("li",{key:a,staticClass:"suggest-item",on:{click:function(s){e.selectItem(t)}}},[s("div",{staticClass:"icon"},[s("i",{staticClass:"iconfont icon-search"})]),e._v(" "),s("div",{staticClass:"name"},[s("p",{staticClass:"text"},[e._v(e._s(e.getDisplayName(t)))])])])}))])},staticRenderFns:[]};var y={name:"Home",data:function(){return{hotKey:[],query:""}},components:{SearchBox:r,MusicSearchSuggest:s("vSla")(v,m,!1,function(e){s("Jzdj")},"data-v-30024626",null).exports},created:function(){this._getHotKey()},methods:{onQueryChange:function(e){this.query=e},addQuery:function(e){this.$refs.searchBox.setQuery(e)},_getHotKey:function(){var e,t=this;(e=Object.assign({},o.c,{uin:0,needNewCode:1,platform:"h5"}),Object(i.a)("https://c.y.qq.com/splcloud/fcgi-bin/gethotkey.fcg",e,o.e)).then(function(e){e.code===o.a&&(t.hotKey=e.data.hotkey.slice(0,10))})}}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"music-search"},[s("div",{staticClass:"search-box-wrapper"},[s("search-box",{ref:"searchBox",on:{query:e.onQueryChange}})],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.query,expression:"!query"}],staticClass:"shortcut-wrapper"},[s("div",{staticClass:"shortcut"},[s("div",[s("div",{staticClass:"hot-key"},[s("h1",{staticClass:"title"},[e._v("热门搜索")]),e._v(" "),s("ul",e._l(e.hotKey,function(t){return s("li",{key:t.n,staticClass:"item",on:{click:function(s){e.addQuery(t.k)}}},[s("span",[e._v(e._s(t.k))])])}))])])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.query,expression:"query"}],staticClass:"search-result"},[s("music-search-suggest",{attrs:{query:e.query}})],1),e._v(" "),s("router-view")],1)},staticRenderFns:[]};var q=s("vSla")(y,_,!1,function(e){s("PN+p")},"data-v-e875d00c",null);t.default=q.exports},jJ4c:function(e,t){}});
//# sourceMappingURL=2.10dd33ded0c6338d9efc.js.map